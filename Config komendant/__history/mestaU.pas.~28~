unit mestaU;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.Samples.Spin, Vcl.StdCtrls,
  Vcl.ExtCtrls, Uni, UniProvider, MySQLUniProvider;

type
  TForm3 = class(TForm)
    Label1: TLabel;
    Label2: TLabel;
    Panel1: TPanel;
    Panel2: TPanel;
    Button1: TButton;
    procedure FormShow(Sender: TObject);
    procedure Button1Click(Sender: TObject);
    function GetArrayValuesAsString1: string;
    function GetArrayValuesAsString2: string;
  private
    arr, arr2: array of array of Integer;
    spinEdit1, spinEdit2: array of TSpinEdit;
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form3: TForm3;
implementation

uses
  ServerU;

{$R *.dfm}

function TForm3.GetArrayValuesAsString1: string;
var
  i: Integer;
begin
  Result := '';
  for i := 0 to balki - 1 do
  begin
    Result := Result + 'Домик №' + IntToStr(arr[i, 0]) + ': ' + IntToStr(arr[i, 1]) + #13#10;
  end;
end;

function TForm3.GetArrayValuesAsString2: string;
var
  i: Integer;
begin
  Result := '';
  for i := 0 to obchaga - 1 do
  begin
    Result := Result + 'Комната №' + IntToStr(arr2[i, 0]) + ': ' + IntToStr(arr2[i, 1]) + #13#10;
  end;
end;

procedure TForm3.Button1Click(Sender: TObject);
var
  i: Integer;
  connection: TUniConnection;
  query: TUniQuery;
begin
  SetLength(arr, balki, 2); // устанавливаем размер массива
  for i := 0 to balki - 1 do
  begin
    arr[i, 0] := i + 1; // сохраняем порядковый номер
    arr[i, 1] := spinEdit1[i].Value; // сохраняем значение SpinEdit из массива spinEdit
  end;
  SetLength(arr2, obchaga, 2); // устанавливаем размер массива
  for i := 0 to obchaga - 1 do
  begin
    arr2[i, 0] := i + 1; // сохраняем порядковый номер
    arr2[i, 1] := spinEdit2[i].Value; // сохраняем значение SpinEdit из массива spinEdit
  end;
  ShowMessage(GetArrayValuesAsString1+' ' +GetArrayValuesAsString2); // выводим сообщение со значениями массива

   // Устанавливаем параметры подключения к базе данных MySQL
  connection := TUniConnection.Create(nil);
  try
    connection.ProviderName := 'MySQL';
    connection.Server := serverDB;
    connection.Username := userDB;
    connection.Password := passDB;

    // Открываем соединение с базой данных
    connection.Connect;

    // Создаем и выполняем запрос для добавления данных в базу данных
    query := TUniQuery.Create(nil);
    try
      query.Connection := connection;
      query.SQL.Text := 'INSERT INTO komendant (Номер, "Кол-во мест") VALUES (:Номер, :КолвоМест)';

      for i := 0 to balki - 1 do
      begin
        query.ParamByName('Номер').AsInteger := arr[i, 0];
        query.ParamByName('КолвоМест').AsInteger := arr[i, 1];
        query.ExecSQL;
      end;
    finally
      query.Free;
    end;
  finally
    // Закрываем соединение с базой данных
    connection.Disconnect;
    connection.Free;
  end;
end;

procedure TForm3.FormShow(Sender: TObject);
var
  i: Integer;
  labelNum: TLabel;
begin
  SetLength(spinEdit1, balki); // устанавливаем размер массива spinEdit1
  SetLength(spinEdit2, obchaga);
  for i := 0 to balki - 1 do
  begin
    spinEdit1[i] := TSpinEdit.Create(Self); // создание нового элемента SpinEdit
    spinEdit1[i].Parent := Panel1; // установка формы как родительского элемента
    spinEdit1[i].Left := 0; // начальная позиция слева
    spinEdit1[i].Top := 10 + i * (spinEdit1[i].Height + 10); // позиция сверху для текущего элемента
    spinEdit1[i].Width := 40; // ширина
    spinEdit1[i].Height := 20; // высота
    labelNum := TLabel.Create(Self); // создание нового элемента Label
    labelNum.Parent := Panel1; // установка формы как родительского элемента
    labelNum.Left := spinEdit1[i].Left + spinEdit1[i].Width + 10; // позиция слева для текущего элемента
    labelNum.Top := spinEdit1[i].Top; // сохраняем позицию сверху у SpinEdit
    labelNum.Caption := 'Домик №' + IntToStr(i + 1); // установка порядкового номера в заголовок Label
  end;
  for i := 0 to obchaga - 1 do
  begin
    spinEdit2[i] := TSpinEdit.Create(Self); // создание нового элемента SpinEdit
    spinEdit2[i].Parent := Panel2; // установка формы как родительского элемента
    spinEdit2[i].Left := 0; // начальная позиция слева
    spinEdit2[i].Top := 10 + i * (spinEdit2[i].Height + 10); // позиция сверху для текущего элемента
    spinEdit2[i].Width := 40; // ширина
    spinEdit2[i].Height := 20; // высота
    labelNum := TLabel.Create(Self); // создание нового элемента Label
    labelNum.Parent := Panel2; // установка формы как родительского элемента
    labelNum.Left := spinEdit2[i].Left + spinEdit2[i].Width + 10; // позиция слева для текущего элемента
    labelNum.Top := spinEdit2[i].Top; // сохраняем позицию сверху у SpinEdit
    labelNum.Caption := 'Комната' + IntToStr(i + 1); // установка порядкового номера в заголовок Label
  end;
end;

end.
